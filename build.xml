<?xml version="1.0"?>
<project name="TrekBuddy" default="generic" basedir=".">

    <property name="version" value="0.9.64"/>
    <property name="vendor" value="KrUcH"/>
    <property name="description" value="J2ME GPS application"/>

    <property name="wtk.cldc.version" value="1.1"/>
    <property name="wtk.midp.version" value="2.0"/>

    <property name="wtk.home" value="c:\J2ME\WTK2.5.1"/>
    <property name="motorola.home" value="c:\J2ME\Motorola\SDKv6.2\EmulatorM.3"/>
    <property name="rim41.home" value="c:\J2ME\RIM\JDE 4.1.0"/>
    <property name="rim42.home" value="c:\J2ME\RIM\JDE"/>
    <property name="proguard.home" value="z:\apps\proguard3.10"/>
<!--
    <property name="bb.buildjars.home" location="${rim41.home}/bin"/>
-->

    <taskdef resource="antenna.properties" classpath="lib/antenna-bin-0.9.14.jar"/>
<!--
    <taskdef name="wtkrapc" classname="de.pleumann.antenna.WtkRapc" classpath="lib/antenna-bin-0.9.14.jar"/>
-->
    <property name="classpath.proguard" value="${proguard.home}\lib\proguard.jar"/>

    <path id="bootclasspath.generic">
        <pathelement location="${wtk.home}\lib\cldcapi11.jar"/>
        <pathelement location="${wtk.home}\lib\midpapi20.jar"/>
        <pathelement location="${wtk.home}\lib\jsr75.jar"/>
        <pathelement location="${wtk.home}\lib\jsr082.jar"/>
        <pathelement location="${wtk.home}\lib\jsr179.jar"/>
        <pathelement location="${wtk.home}\lib\wma11.jar"/>
        <pathelement location="${wtk.home}\lib\mmapi.jar"/>
        <pathelement location="lib\motorola-ext.jar"/>
        <pathelement location="lib\motorola-file.jar"/>
        <pathelement location="lib\motorola-location.jar"/>
        <pathelement location="lib\nokia-ui.jar"/>
        <pathelement location="lib\siemens-file.jar"/>
        <pathelement location="lib\siemens-game.jar"/>
    </path>

    <path id="bootclasspath.std">
        <pathelement location="${wtk.home}\lib\cldcapi11.jar"/>
        <pathelement location="${wtk.home}\lib\midpapi20.jar"/>
        <pathelement location="${wtk.home}\lib\jsr75.jar"/>
        <pathelement location="${wtk.home}\lib\jsr082.jar"/>
        <pathelement location="${wtk.home}\lib\jsr179.jar"/>
        <pathelement location="${wtk.home}\lib\wma11.jar"/>
        <pathelement location="${wtk.home}\lib\mmapi.jar"/>
    </path>

    <path id="bootclasspath.rim41">
        <pathelement location="${rim41.home}\lib\net_rim_api.jar"/>
    </path>

    <path id="bootclasspath.rim42">
        <pathelement location="${rim42.home}\lib\net_rim_api.jar"/>
    </path>

    <target name="generic">
        <property name="suffix" value=""/>
        <property name="dist.dir" value="generic"/>
        <property name="libraryjars" value="${wtk.home}\lib\cldcapi11.jar;${wtk.home}\lib\midpapi20.jar;${wtk.home}\lib\jsr75.jar;${wtk.home}\lib\jsr082.jar;${wtk.home}\lib\jsr179.jar;${wtk.home}\lib\wma11.jar;lib\motorola-location.jar"/>
        <property name="classpath.preverify" value="${libraryjars}"/>
        <antcall target="clean"/>
        <antcall target="a.pre.generic"/>
        <antcall target="compile.generic"/>
        <antcall target="a.pack" inheritall="true"/>
        <antcall target="obfuscate" inheritall="true"/>
        <antcall target="preverify" inheritall="true"/>
        <antcall target="a.pack.obfuscated" inheritall="true"/>
<!--
        <antcall target="delegate" inheritall="true"/>
-->
        <antcall target="sign.and.update" inheritall="true"/>
    </target>

    <target name="std">
        <property name="suffix" value="-std"/>
        <property name="dist.dir" value="std"/>
        <property name="libraryjars" value="${wtk.home}\lib\cldcapi11.jar;${wtk.home}\lib\midpapi20.jar;${wtk.home}\lib\jsr75.jar;${wtk.home}\lib\jsr082.jar;${wtk.home}\lib\jsr179.jar;${wtk.home}\lib\wma11.jar"/>
        <property name="classpath.preverify" value="${libraryjars}"/>
        <antcall target="clean"/>
        <antcall target="a.pre.std"/>
        <antcall target="compile.std"/>
        <antcall target="a.pack" inheritall="true"/>
        <antcall target="obfuscate" inheritall="true"/>
        <antcall target="preverify" inheritall="true"/>
        <antcall target="a.pack.obfuscated" inheritall="true"/>
<!--
        <antcall target="delegate" inheritall="true"/>
-->
        <antcall target="sign.and.update" inheritall="true"/>
    </target>

    <target name="j9">
        <property name="suffix" value="-j9"/>
        <property name="dist.dir" value="j9"/>
        <property name="libraryjars" value="${wtk.home}\lib\cldcapi11.jar;${wtk.home}\lib\midpapi20.jar;${wtk.home}\lib\jsr75.jar;${wtk.home}\lib\jsr082.jar;${wtk.home}\lib\jsr179.jar;${wtk.home}\lib\wma11.jar"/>
        <property name="classpath.preverify" value="${libraryjars}"/>
        <antcall target="clean"/>
        <antcall target="a.pre.std"/>
        <antcall target="compile.std"/>
        <antcall target="j9.pack" inheritall="true"/>
        <antcall target="obfuscate" inheritall="true"/>
        <antcall target="preverify" inheritall="true"/>
        <antcall target="j9.pack.obfuscated" inheritall="true"/>
<!--
        <antcall target="delegate" inheritall="true"/>
-->
        <antcall target="sign.and.update" inheritall="true"/>
    </target>

    <target name="rim41">
        <property name="suffix" value="_bb_v41"/>
        <property name="dist.dir" value="rim41"/>
        <property name="rim.home" value="${rim41.home}"/>
        <property name="libraryjars" value="${rim41.home}\lib\net_rim_api.jar"/>
        <property name="classpath.preverify" value="${libraryjars}"/>
        <antcall target="clean"/>
        <antcall target="a.pre.rim"/>
        <antcall target="compile.rim41"/>
        <antcall target="a.pack" inheritall="true"/>
        <antcall target="rim.obfuscate" inheritall="true"/>
        <antcall target="rim.preverify" inheritall="true"/>
        <antcall target="rim.pack.obfuscated" inheritall="true"/>
<!--
        <antcall target="delegate" inheritall="true"/>
-->
<!--
        <antcall target="sign.and.update" inheritall="true"/>
-->
        <antcall target="rapc" inheritall="true"/>
    </target>

    <target name="rim42">
        <property name="suffix" value="_bb_v42"/>
        <property name="dist.dir" value="rim42"/>
        <property name="rim.home" value="${rim42.home}"/>
        <property name="libraryjars" value="${rim42.home}\lib\net_rim_api.jar"/>
        <property name="classpath.preverify" value="${libraryjars}"/>
        <antcall target="clean"/>
        <antcall target="a.pre.rim"/>
        <antcall target="compile.rim42"/>
        <antcall target="a.pack" inheritall="true"/>
        <antcall target="rim.obfuscate" inheritall="true"/>
        <antcall target="rim.preverify" inheritall="true"/>
        <antcall target="rim.pack.obfuscated" inheritall="true"/>
<!--
        <antcall target="delegate" inheritall="true"/>
-->
<!--
        <antcall target="sign.and.update" inheritall="true"/>
-->
        <antcall target="rapc" inheritall="true"/>
    </target>

    <target name="clean">
        <delete dir="tmp"/>
        <delete includeemptydirs="true" verbose="true">
          <fileset dir="dist/${dist.dir}" includes="**/*"/>
        </delete>
<!--
        <delete dir="r:\trekbuddy\tmp"/>
-->
        <copy file="res/resources/language.txt" todir="res-J9/resources" overwrite="true"/>
        <copy file="res/resources/language.txt" todir="res-RIM/resources" overwrite="true"/>
    </target>

    <target name="a.pre.generic">
        <mkdir dir="tmp/src"/>
        <wtkpreprocess srcdir="src" destdir="tmp/src" symbols="__JSR75__,__S65__,__A780__,__A1000__"/>
    </target>

    <target name="a.pre.std">
        <mkdir dir="tmp/src"/>
        <wtkpreprocess srcdir="src" destdir="tmp/src" symbols="__JSR75__"/>
    </target>

    <target name="a.pre.rim">
        <mkdir dir="tmp/src"/>
        <wtkpreprocess srcdir="src" destdir="tmp/src" symbols="__JSR75__,__RIM__"/>
    </target>

    <target name="compile.generic">
        <mkdir dir="tmp/build/classes"/>
        <javac srcdir="tmp/src"
               destdir="tmp/build/classes"
               fork="true"
               target="1.1" source="1.3"
               bootclasspathref="bootclasspath.generic"/>
    </target>

    <target name="compile.std" depends="remove.nonstd.src">
        <mkdir dir="tmp/build/classes"/>
        <javac srcdir="tmp/src"
               destdir="tmp/build/classes"
               fork="true"
               target="1.1" source="1.3"
               bootclasspathref="bootclasspath.std"/>
    </target>

    <target name="compile.rim41" depends="remove.nonrim41.src">
        <mkdir dir="tmp/build/classes"/>
        <javac srcdir="tmp/src"
               destdir="tmp/build/classes"
               fork="true"
               target="1.1" source="1.3"
               bootclasspathref="bootclasspath.rim41"/>
    </target>

    <target name="compile.rim42" depends="remove.nonrim42.src">
        <mkdir dir="tmp/build/classes"/>
        <javac srcdir="tmp/src"
               destdir="tmp/build/classes"
               fork="true"
               target="1.1" source="1.3"
               bootclasspathref="bootclasspath.rim42"/>
    </target>

    <target name="remove.nonstd.src">
        <delete file="tmp/src/api/file/MotorolaFile.java"/>
        <delete file="tmp/src/api/file/Motorola1000File.java"/>
        <delete file="tmp/src/api/file/SiemensFile.java"/>
        <delete file="tmp/src/cz/kruch/track/ui/nokia/NokiaDeviceControl.java"/>
        <delete file="tmp/src/cz/kruch/track/ui/nokia/SiemensDeviceControl.java"/>
        <delete file="tmp/src/cz/kruch/track/ui/nokia/SonyEricssonDeviceControl.java"/>
        <delete file="tmp/src/cz/kruch/track/location/MotorolaLocationProvider.java"/>
    </target>

    <target name="remove.nonrim41.src">
        <delete file="tmp/src/api/file/MotorolaFile.java"/>
        <delete file="tmp/src/api/file/Motorola1000File.java"/>
        <delete file="tmp/src/api/file/SiemensFile.java"/>
        <delete file="tmp/src/api/file/Jsr75File.java"/>
        <delete file="tmp/src/cz/kruch/track/ui/nokia/NokiaDeviceControl.java"/>
        <delete file="tmp/src/cz/kruch/track/ui/nokia/SiemensDeviceControl.java"/>
        <delete file="tmp/src/cz/kruch/track/ui/nokia/SonyEricssonDeviceControl.java"/>
        <delete file="tmp/src/cz/kruch/track/location/MotorolaLocationProvider.java"/>
        <delete file="tmp/src/cz/kruch/track/location/Jsr82LocationProvider.java"/>
    </target>

    <target name="remove.nonrim42.src">
        <delete file="tmp/src/api/file/MotorolaFile.java"/>
        <delete file="tmp/src/api/file/Motorola1000File.java"/>
        <delete file="tmp/src/api/file/SiemensFile.java"/>
        <delete file="tmp/src/cz/kruch/track/ui/nokia/NokiaDeviceControl.java"/>
        <delete file="tmp/src/cz/kruch/track/ui/nokia/SiemensDeviceControl.java"/>
        <delete file="tmp/src/cz/kruch/track/ui/nokia/SonyEricssonDeviceControl.java"/>
        <delete file="tmp/src/cz/kruch/track/location/MotorolaLocationProvider.java"/>
    </target>

    <target name="a.pack">
        <copy file="trekbuddy.jad" tofile="tmp/trekbuddy${suffix}.jad" overwrite="true"/>
        <wtkpackage jarfile="tmp/trekbuddy${suffix}.jar"
                    jadfile="tmp/trekbuddy${suffix}.jad">
            <fileset dir="tmp/build/classes"/>
            <fileset dir="res"/>
        </wtkpackage>
    </target>

    <target name="j9.pack">
        <copy file="trekbuddy.jad" tofile="tmp/trekbuddy${suffix}.jad" overwrite="true"/>
        <wtkpackage jarfile="tmp/trekbuddy${suffix}.jar"
                    jadfile="tmp/trekbuddy${suffix}.jad">
            <fileset dir="tmp/build/classes"/>
            <fileset dir="res-J9"/>
        </wtkpackage>
    </target>

    <target name="delegate">
        <copy file="tmp/trekbuddy${suffix}-obfuscated.jar" todir="r:\trekbuddy\tmp"/>
        <input>Do preverification on Linux....</input>
        <copy file="r:\trekbuddy\dist\${dist.dir}\trekbuddy${suffix}.jar" todir="dist/${dist.dir}"/>
        <copy file="r:\trekbuddy\dist\${dist.dir}\trekbuddy${suffix}.jad" todir="dist/${dist.dir}"/>
    </target>

    <target name="a.pack.obfuscated">
        <delete>
          <fileset dir="dist/${dist.dir}" includes="**/*.jar"/>
        </delete>
        <wtkjad jadfile="dist/${dist.dir}/trekbuddy${suffix}.jad"
                jarfile="dist/${dist.dir}/trekbuddy${suffix}.jar"
                name="TrekBuddy"
                vendor="${vendor}"
                version="${version}">
            <midlet name="TrekBuddy" class="cz.kruch.track.TrackingMIDlet"/>
            <attribute name="MIDlet-Description" value="${description}"/>
            <attribute name="MIDlet-Info-URL" value="http://www.trekbuddy.net"/>
            <attribute name="MIDlet-Permissions-Opt" value="javax.microedition.io.Connector.file.read,javax.microedition.io.Connector.file.write,javax.microedition.io.Connector.bluetooth.client,javax.microedition.location.Location,javax.microedition.media.control.VideoControl.getSnapshot,javax.microedition.io.Connector.sms,javax.wireless.messaging.sms.receive,javax.wireless.messaging.sms.send,javax.microedition.io.Connector.comm"/>            <attribute name="MicroEdition-Profile" value="MIDP-2.0"/>
            <attribute name="MicroEdition-Profile" value="MIDP-2.0"/>
            <attribute name="MicroEdition-Configuration" value="CLDC-1.1"/>
        </wtkjad>
        <wtkpackage jarfile="dist/${dist.dir}/trekbuddy${suffix}.jar"
                    jadfile="dist/${dist.dir}/trekbuddy${suffix}.jad">
            <fileset dir="tmp/preverified"/>
            <fileset dir="res"/>
        </wtkpackage>
    </target>

    <target name="j9.pack.obfuscated">
        <delete>
          <fileset dir="dist/${dist.dir}" includes="**/*.jar"/>
        </delete>
        <wtkjad jadfile="dist/${dist.dir}/trekbuddy${suffix}.jad"
                jarfile="dist/${dist.dir}/trekbuddy${suffix}.jar"
                name="TrekBuddy"
                vendor="${vendor}"
                version="${version}">
            <midlet name="TrekBuddy" class="cz.kruch.track.TrackingMIDlet"/>
		<attribute name="MIDlet-Description" value="${description}"/>
		<attribute name="MIDlet-Info-URL" value="http://www.trekbuddy.net"/>
            <attribute name="MIDlet-Permissions-Opt" value="javax.microedition.io.Connector.file.read,javax.microedition.io.Connector.file.write,javax.microedition.io.Connector.bluetooth.client,javax.microedition.location.Location,javax.microedition.media.control.VideoControl.getSnapshot,javax.microedition.io.Connector.sms,javax.wireless.messaging.sms.receive,javax.wireless.messaging.sms.send,javax.microedition.io.Connector.comm"/>
            <attribute name="MicroEdition-Profile" value="MIDP-2.0"/>
            <attribute name="MicroEdition-Configuration" value="CLDC-1.1"/>
        </wtkjad>
        <wtkpackage jarfile="dist/${dist.dir}/trekbuddy${suffix}.jar"
                    jadfile="dist/${dist.dir}/trekbuddy${suffix}.jad">
            <fileset dir="tmp/preverified"/>
            <fileset dir="res-J9"/>
        </wtkpackage>
    </target>

    <target name="rim.pack.obfuscated">
        <delete>
          <fileset dir="dist/${dist.dir}" includes="**/*.jar"/>
        </delete>
        <wtkjad jadfile="dist/${dist.dir}/trekbuddy${suffix}.jad"
                jarfile="dist/${dist.dir}/trekbuddy${suffix}.jar"
                name="TrekBuddy"
                vendor="${vendor}"
                version="${version}">
            <midlet name="TrekBuddy" class="cz.kruch.track.TrackingMIDlet"/>
            <attribute name="MIDlet-Description" value="${description}"/>
            <attribute name="MIDlet-Info-URL" value="http://www.trekbuddy.net"/>
            <attribute name="MIDlet-Permissions-Opt" value="javax.microedition.io.Connector.file.read,javax.microedition.io.Connector.file.write,javax.microedition.io.Connector.bluetooth.client,javax.microedition.location.Location,javax.microedition.media.control.VideoControl.getSnapshot,javax.microedition.io.Connector.sms,javax.wireless.messaging.sms.receive,javax.wireless.messaging.sms.send,javax.microedition.io.Connector.comm"/>            <attribute name="MicroEdition-Profile" value="MIDP-2.0"/>
            <attribute name="MicroEdition-Profile" value="MIDP-2.0"/>
            <attribute name="MicroEdition-Configuration" value="CLDC-1.1"/>
        </wtkjad>
        <wtkpackage jarfile="dist/${dist.dir}/trekbuddy${suffix}.jar"
                    jadfile="dist/${dist.dir}/trekbuddy${suffix}.jad">
            <fileset dir="tmp/preverified"/>
            <fileset dir="res-RIM"/>
        </wtkpackage>
    </target>

    <target name="sign.and.update">
        <java jar="${wtk.home}\bin\JadTool.jar" fork="true">
            <arg line="-addcert -certnum 1 -alias 'trekbuddy' -keystore trekbuddy.jks -inputjad dist/${dist.dir}/trekbuddy${suffix}.jad -outputjad dist/${dist.dir}/_trekbuddy${suffix}.jad"/>
        </java>
        <move file="dist/${dist.dir}/_trekbuddy${suffix}.jad" tofile="dist/${dist.dir}/trekbuddy${suffix}.jad"/>
        <java jar="${wtk.home}\bin\JadTool.jar" fork="true">
            <arg line="-addcert -certnum 2 -alias 'trekbuddy' -keystore trekbuddy.jks -inputjad dist/${dist.dir}/trekbuddy${suffix}.jad -outputjad dist/${dist.dir}/_trekbuddy${suffix}.jad"/>
        </java>
        <move file="dist/${dist.dir}/_trekbuddy${suffix}.jad" tofile="dist/${dist.dir}/trekbuddy${suffix}.jad"/>
        <java jar="${wtk.home}\bin\JadTool.jar" fork="true">
            <arg line="-addcert -certnum 3 -alias 'trekbuddy' -keystore trekbuddy.jks -inputjad dist/${dist.dir}/trekbuddy${suffix}.jad -outputjad dist/${dist.dir}/_trekbuddy${suffix}.jad"/>
        </java>
        <move file="dist/${dist.dir}/_trekbuddy${suffix}.jad" tofile="dist/${dist.dir}/trekbuddy${suffix}.jad"/>
        <java jar="${wtk.home}\bin\JadTool.jar" fork="true">
            <arg line="-addjarsig -alias 'trekbuddy' -keystore trekbuddy.jks -keypass changeit -jarfile dist/${dist.dir}/trekbuddy${suffix}.jar -inputjad dist/${dist.dir}/trekbuddy${suffix}.jad -outputjad dist/${dist.dir}/_trekbuddy${suffix}.jad"/>
        </java>
        <move file="dist/${dist.dir}/_trekbuddy${suffix}.jad" tofile="dist/${dist.dir}/trekbuddy${suffix}.jad"/>
<!--
        <wtkjad jadfile="dist/${dist.dir}/trekbuddy${suffix}.jad" update="true">
            <attribute name="Datum-1" value="S-42 (Poland){Krassovsky 1940,24,-124,-82}=map:Pulkovo 1942 POL"/>
        </wtkjad>
-->
    </target>

    <target name="obfuscate">
	  <java jar="${proguard.home}\lib\proguard.jar" fork="true">
            <arg value="-injars tmp/trekbuddy${suffix}.jar"/>
            <arg value="-outjars tmp/trekbuddy${suffix}-obfuscated.jar"/>
            <arg value="-libraryjars ${libraryjars}"/>
            <arg value="-dontusemixedcaseclassnames"/>
            <arg value="-defaultpackage ''"/>
            <arg value="-overloadaggressively"/>
            <arg value="-allowaccessmodification"/>
            <arg value="-keep public class cz.kruch.track.TrackingMIDlet {
                public TrackingMIDlet();
                protected void startApp();
                protected void pauseApp();
                protected void destroyApp(boolean);
                public void run();
            }"/>
<!-- kXML
            <arg value="-keepnames class org.**"/>
-->
            <arg value="-keepnames class cz.** extends java.lang.Exception"/>
            <arg value="-whyareyoukeeping class cz.kruch.track.ui.Desktop$Renderer"/>
            <arg value="-whyareyoukeeping class cz.kruch.track.util.Logger"/>
            <arg value="-whyareyoukeeping class cz.kruch.track.location.MotorolaLocationProvider"/>
            <arg value="-printmapping dist/${dist.dir}/trekbuddy${suffix}.map"/>
            <arg value="-printseeds"/>
            <arg value="-verbose"/>
        </java>
    </target> 

    <target name="rim.obfuscate">
	  <java jar="${proguard.home}\lib\proguard.jar" fork="true">
            <arg value="-injars tmp/trekbuddy${suffix}.jar"/>
            <arg value="-outjars tmp/trekbuddy${suffix}-obfuscated.jar"/>
            <arg value="-libraryjars '${libraryjars}'"/>
            <arg value="-dontusemixedcaseclassnames"/>
            <arg value="-defaultpackage ''"/>
<!--
            <arg value="-overloadaggressively"/>
            <arg value="-allowaccessmodification"/>
-->
            <arg value="-keep public class cz.kruch.track.TrackingMIDlet {
                public TrackingMIDlet();
                protected void startApp();
                protected void pauseApp();
                protected void destroyApp(boolean);
            }"/>
<!-- kXML
            <arg value="-keepnames class org.**"/>
-->
            <arg value="-keepnames class cz.** extends java.lang.Exception"/>
            <arg value="-whyareyoukeeping class cz.kruch.track.ui.Desktop$Renderer"/>
            <arg value="-whyareyoukeeping class cz.kruch.track.util.Logger"/>
            <arg value="-whyareyoukeeping class cz.kruch.track.location.MotorolaLocationProvider"/>
            <arg value="-printmapping dist/${dist.dir}/trekbuddy${suffix}.map"/>
            <arg value="-printseeds"/>
            <arg value="-verbose"/>
        </java>
    </target> 
	
	<target name="preverify">
	    <unjar src="tmp/trekbuddy${suffix}-obfuscated.jar" dest="tmp/obfuscated"/>
	    <exec executable="${wtk.home}\bin\preverify1.1.exe">
		  <arg line="-classpath ${classpath.preverify} -d tmp/preverified tmp/obfuscated"/>
	    </exec>
	</target>

	<target name="rim.preverify">
	    <unjar src="tmp/trekbuddy${suffix}-obfuscated.jar" dest="tmp/obfuscated"/>
          <echo>Using ${classpath.preverify} for preverification...</echo>
	    <exec executable="${rim.home}\bin\preverify.exe">
		  <arg line="-classpath '${classpath.preverify}' -d tmp/preverified tmp/obfuscated"/>
        </exec>
	</target>

      <target name="rapc">
          <echo>Using rim.home=${rim.home}</echo>
<!--
          <ant antfile="bb.xml"/>
-->
<!--
          <wtkrapc quiet="true" midlet="true" codename="trekbuddy${suffix}"
    	        jadfile="dist/${dist.dir}/trekbuddy${suffix}.jad" 
    	        source="dist/${dist.dir}/trekbuddy${suffix}.jar" 
     	        import="${rim.home}/lib/net_rim_api.jar"
    	        destdir="dist/${dist.dir}/cod"/>
-->
<!--
          <exec dir="${basedir}\dist\${dist.dir}" executable="${rim.home}\bin\rapc.exe">
            <arg line="import='${rim.home}\lib\net_rim_api.jar' codename=trekbuddy${suffix} -quiet ${basedir}\dist\${dist.dir}\trekbuddy${suffix}.jad ${basedir}\dist\${dist.dir}\trekbuddy${suffix}.jar"/>
          </exec>
-->
          <exec dir="${basedir}\dist\${dist.dir}" executable="${rim.home}\bin\rapc.exe">
            <arg line="import='${rim.home}\lib\net_rim_api.jar' codename=trekbuddy${suffix} -quiet -midlet ${basedir}\dist\${dist.dir}\trekbuddy${suffix}.jad ${basedir}\dist\${dist.dir}\trekbuddy${suffix}.jar"/>
          </exec>
          <copy file="${basedir}\trekbuddy.alx" tofile="${basedir}\dist\${dist.dir}\trekbuddy${suffix}.alx"/>
          <replace file="${basedir}\dist\${dist.dir}\trekbuddy${suffix}.alx" token="@SUFFIX@" value="${suffix}"/>
          <replace file="${basedir}\dist\${dist.dir}\trekbuddy${suffix}.alx" token="@DESCRIPTION@" value="${description}"/>
          <replace file="${basedir}\dist\${dist.dir}\trekbuddy${suffix}.alx" token="@VERSION@" value="${version}"/>
          <replace file="${basedir}\dist\${dist.dir}\trekbuddy${suffix}.alx" token="@VENDOR@" value="${vendor}"/>
          <delete>
              <fileset dir="${basedir}\dist\${dist.dir}" excludes="*.cod,*.alx,*.map"/>
          </delete>
      </target>

</project>
